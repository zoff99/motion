machine:
  timezone:
    Europe/Berlin
  environment:
    MAKEFLAGS: "j4"
    BUILD__: "ubuntu_14_04"
dependencies:
  pre:
  - sudo apt-get update
  - sudo apt-get install clang
  - sudo apt-get install build-essential libtool autotools-dev automake checkinstall check git yasm
  - sudo apt-get install libopus-dev libvpx-dev pkg-config
  - sudo apt-get install build-essential libjpeg8-dev libzip-dev autoconf automake pkgconf libtool git
  - sudo apt-get install libavformat-dev libavcodec-dev libavutil-dev libswscale-dev libavdevice-dev
  - sudo apt-get install libsqlite3-dev libpq-dev libmysqlclient-dev libwebp-dev

  - gcc --version ; exit 0
  - clang --version ; exit 0
compile:
  override:
  - autoreconf -fiv
  - ./configure --help
  - mkdir -p /home/ubuntu/inst/
  - ./configure --prefix=/home/ubuntu/inst/
  - make
  - make check ; exit 0
test:
  override:
  - make install
  - ls -alR /home/ubuntu/inst/
  - mkdir -p $CIRCLE_ARTIFACTS/"$BUILD__"
  - cd /home/ubuntu/inst/ ; tar -czvf $CIRCLE_ARTIFACTS/"$BUILD__"/motion_pkg.tar.gz *



